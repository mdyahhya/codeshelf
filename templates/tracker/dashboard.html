<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CodeShelf - Professional Learning Tracker by Yahya Mundewadi</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #667eea;
            --primary-dark: #5568d3;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --dark: #343a40;
            --light: #f8f9fa;
            --white: #ffffff;
            --text: #333333;
            --text-light: #666666;
        }
        
        [data-theme="dark"] {
            --white: #1e1e1e;
            --light: #2d2d2d;
            --text: #f0f0f0;
            --text-light: #b0b0b0;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
            transition: background 0.3s ease;
        }
        
        body[data-theme="dark"] {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Header */
        header {
            background: var(--white);
            padding: 25px 30px;
            border-radius: 15px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .header-content h1 {
            color: var(--primary);
            font-size: 2em;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .subtitle {
            color: var(--text-light);
            font-size: 0.95em;
        }
        
        .header-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        /* Footer Credit */
        .footer-credit {
            background: var(--white);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .footer-credit p {
            color: var(--text);
            margin: 5px 0;
        }
        
        .footer-credit a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }
        
        .footer-credit a:hover {
            text-decoration: underline;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--primary);
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        }
        
        .stat-card h3 {
            color: var(--text-light);
            font-size: 0.85em;
            text-transform: uppercase;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }
        
        .stat-number {
            font-size: 2.8em;
            font-weight: bold;
            color: var(--primary);
        }
        
        /* Main Section */
        .section {
            background: var(--white);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .section-header h2 {
            color: var(--text);
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* Search Bar */
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        .search-container input {
            width: 100%;
            padding: 14px 50px 14px 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            background: var(--white);
            color: var(--text);
        }
        
        .search-container input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            opacity: 0.5;
        }
        
        /* Filter Buttons */
        .filter-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        /* Buttons */
        .btn {
            background: var(--primary);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success { background: var(--success); }
        .btn-danger { background: var(--danger); }
        .btn-warning { background: var(--warning); color: #333; }
        .btn-info { background: var(--info); }
        .btn-dark { background: var(--dark); }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 0.85em;
        }
        
        .btn svg {
            width: 18px;
            height: 18px;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }
        
        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .modal-content {
            background: var(--white);
            padding: 35px;
            border-radius: 15px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }
        
        .modal-close {
            position: absolute;
            right: 15px;
            top: 15px;
            width: 35px;
            height: 35px;
            border: none;
            background: var(--danger);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            transform: rotate(90deg);
            background: #c82333;
        }
        
        .modal h2 {
            color: var(--text);
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .modal p, .modal li {
            color: var(--text);
            line-height: 1.8;
            margin-bottom: 15px;
        }
        
        .modal ul {
            padding-left: 20px;
        }
        
        .modal strong {
            color: var(--primary);
        }
        
        /* Form */
        .form-container {
            background: var(--light);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            display: none;
        }
        
        .form-container.active {
            display: block;
            animation: slideDown 0.3s ease;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 5px;
            color: var(--text);
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 0.95em;
            font-family: inherit;
            transition: all 0.3s ease;
            background: var(--white);
            color: var(--text);
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        /* Table */
        .table-container {
            overflow-x: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 900px;
        }
        
        th, td {
            padding: 15px 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
            color: var(--text);
        }
        
        th {
            background: var(--light);
            font-weight: 600;
            font-size: 0.9em;
            text-transform: uppercase;
            cursor: pointer;
            user-select: none;
        }
        
        th:hover {
            background: #e9ecef;
        }
        
        tbody tr {
            transition: background-color 0.2s ease;
        }
        
        tbody tr:hover {
            background: var(--light);
        }
        
        /* Badges */
        .badge {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            display: inline-block;
            white-space: nowrap;
        }
        
        .badge-fsd { background: #e3f2fd; color: #1976d2; }
        .badge-cs { background: #ffebee; color: #c62828; }
        .badge-ds { background: #f3e5f5; color: #7b1fa2; }
        .badge-beginner { background: #fff3e0; color: #ef6c00; }
        .badge-intermediate { background: #e8f5e9; color: #2e7d32; }
        .badge-advanced { background: #e1f5fe; color: #0277bd; }
        .badge-expert { background: #f3e5f5; color: #6a1b9a; }
        
        /* Charts */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        
        .chart-container {
            background: var(--white);
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        
        .chart-container h3 {
            color: var(--text);
            margin-bottom: 15px;
            text-align: center;
        }
        
        /* Alert */
        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
            animation: slideDown 0.3s ease;
        }
        
        .alert.active {
            display: block;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 1000px;
            }
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            header {
                padding: 20px;
                text-align: center;
            }
            
            .header-content h1 {
                font-size: 1.5em;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .section {
                padding: 20px;
            }
            
            .section-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            table {
                font-size: 0.85em;
                min-width: 700px;
            }
            
            .modal-content {
                padding: 25px;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .stat-number {
                font-size: 2.2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <h1>
                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                    CodeShelf
                </h1>
                <p class="subtitle">Professional Programming Learning Tracker</p>
            </div>
            <div class="header-actions">
                <button onclick="openAboutModal()" class="btn btn-info btn-sm">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    About
                </button>
                <button onclick="toggleDarkMode()" class="btn btn-dark btn-sm" id="themeToggle">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    Dark
                </button>
            </div>
        </header>
        
        <!-- Alert Box -->
        <div id="alertBox" class="alert"></div>
        
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Total Languages</h3>
                <div class="stat-number">{{ total_languages }}</div>
            </div>
            <div class="stat-card">
                <h3>Full Stack Dev</h3>
                <div class="stat-number">{{ fsd_count }}</div>
            </div>
            <div class="stat-card">
                <h3>Cyber Security</h3>
                <div class="stat-number">{{ cs_count }}</div>
            </div>
            <div class="stat-card">
                <h3>Data Science</h3>
                <div class="stat-number">{{ ds_count }}</div>
            </div>
        </div>
        
        <!-- Study Session Tracker -->
        <div class="section">
            <div class="section-header">
                <h2>
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    Study Session Tracker
                </h2>
                <button onclick="toggleStudyForm()" class="btn btn-success">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Log Study Session
                </button>
            </div>
            
            <!-- Study Form -->
            <div id="studyForm" class="form-container">
                <h3>Log Your Study Session</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Select Language *</label>
                        <select id="studyLanguage" required>
                            <option value="">Choose...</option>
                            {% for language in languages %}
                            <option value="{{ language.name }}">{{ language.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Study Duration (minutes) *</label>
                        <input type="number" id="studyDuration" min="1" placeholder="e.g., 60" required>
                    </div>
                    <div class="form-group">
                        <label>Date *</label>
                        <input type="date" id="studyDate" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>What did you learn?</label>
                    <textarea id="studyNotes" placeholder="Brief notes about your study session..."></textarea>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 15px;">
                    <button onclick="saveStudySession()" class="btn btn-success">Save Session</button>
                    <button onclick="toggleStudyForm()" class="btn btn-danger">Cancel</button>
                </div>
            </div>
            
            <!-- Study Stats -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px;">
                <div style="background: var(--light); padding: 20px; border-radius: 10px; text-align: center;">
                    <p style="color: var(--text-light); font-size: 0.85em; margin-bottom: 5px;">TODAY</p>
                    <p style="font-size: 2em; font-weight: bold; color: var(--success);" id="todayMinutes">0</p>
                    <p style="color: var(--text-light); font-size: 0.85em;">minutes</p>
                </div>
                <div style="background: var(--light); padding: 20px; border-radius: 10px; text-align: center;">
                    <p style="color: var(--text-light); font-size: 0.85em; margin-bottom: 5px;">THIS WEEK</p>
                    <p style="font-size: 2em; font-weight: bold; color: var(--info);" id="weekMinutes">0</p>
                    <p style="color: var(--text-light); font-size: 0.85em;">minutes</p>
                </div>
                <div style="background: var(--light); padding: 20px; border-radius: 10px; text-align: center;">
                    <p style="color: var(--text-light); font-size: 0.85em; margin-bottom: 5px;">TOTAL SESSIONS</p>
                    <p style="font-size: 2em; font-weight: bold; color: var(--primary);" id="totalSessions">0</p>
                    <p style="color: var(--text-light); font-size: 0.85em;">sessions</p>
                </div>
            </div>
        </div>
        
        <!-- Progress Charts -->
        <div class="section">
            <div class="section-header">
                <h2>
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="20" x2="18" y2="10"></line>
                        <line x1="12" y1="20" x2="12" y2="4"></line>
                        <line x1="6" y1="20" x2="6" y2="14"></line>
                    </svg>
                    Progress Analytics
                </h2>
            </div>
            
            <div class="charts-grid">
                <div class="chart-container">
                    <h3>Languages by Category</h3>
                    <canvas id="categoryChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Proficiency Distribution</h3>
                    <canvas id="proficiencyChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Languages List -->
        <div class="section" id="languagesSection">
            <div class="section-header">
                <h2>
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="16 18 22 12 16 6"></polyline>
                        <polyline points="8 6 2 12 8 18"></polyline>
                    </svg>
                    My Languages & Technologies
                </h2>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button onclick="toggleAddForm()" class="btn btn-success">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add New
                    </button>
                    <button onclick="importLanguages()" class="btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                        Import API
                    </button>
                    <button onclick="exportToCSV()" class="btn btn-success">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        CSV
                    </button>
                    <button onclick="exportToPDF()" class="btn btn-danger">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                        </svg>
                        PDF
                    </button>
                    <button onclick="downloadAsImage()" class="btn btn-info">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                        Image
                    </button>
                </div>
            </div>
            
            <!-- Search Bar -->
            <div class="search-container">
                <input type="text" id="searchBox" onkeyup="searchTable()" placeholder="Search languages, categories, proficiency...">
                <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
            </div>
            
            <!-- Filter Buttons -->
            <div class="filter-buttons">
                <button onclick="filterCategory('all')" class="btn btn-sm btn-dark">All</button>
                <button onclick="filterCategory('FSD')" class="btn btn-sm" style="background: #1976d2;">Full Stack</button>
                <button onclick="filterCategory('CS')" class="btn btn-sm" style="background: #c62828;">Cyber Security</button>
                <button onclick="filterCategory('DS')" class="btn btn-sm" style="background: #7b1fa2;">Data Science</button>
            </div>
            
            <!-- Add/Edit Form -->
            <div id="languageForm" class="form-container">
                <h3 id="formTitle">Add New Language</h3>
                <form id="langForm" onsubmit="return false;">
                    <input type="hidden" id="editId" value="">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Language/Technology Name *</label>
                            <input type="text" id="name" required placeholder="e.g., Python, JavaScript">
                        </div>
                        <div class="form-group">
                            <label>Category *</label>
                            <select id="category" required>
                                <option value="">Select Category</option>
                                <option value="FSD">Full Stack Development</option>
                                <option value="CS">Cyber Security</option>
                                <option value="DS">Data Science</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Proficiency Level *</label>
                            <select id="proficiency" required>
                                <option value="">Select Level</option>
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                                <option value="Expert">Expert</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="description" placeholder="Brief description of your experience"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Learning Resources</label>
                            <textarea id="resources" placeholder="Books, courses, websites, etc."></textarea>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button type="button" onclick="saveLanguage()" class="btn btn-success">Save</button>
                        <button type="button" onclick="cancelForm()" class="btn btn-danger">Cancel</button>
                    </div>
                </form>
            </div>
            
            <!-- Languages Table -->
            <div class="table-container">
                <table id="languagesTable">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0)">Language/Tech â†•</th>
                            <th onclick="sortTable(1)">Category â†•</th>
                            <th onclick="sortTable(2)">Proficiency â†•</th>
                            <th>Description</th>
                            <th onclick="sortTable(4)">Date Added â†•</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for language in languages %}
                        <tr>
                            <td><strong>{{ language.name }}</strong></td>
                            <td>
                                <span class="badge badge-{{ language.category|lower }}">
                                    {{ language.get_category_display }}
                                </span>
                            </td>
                            <td>
                                <span class="badge badge-{{ language.proficiency|lower }}">
                                    {{ language.proficiency }}
                                </span>
                            </td>
                            <td>{{ language.description|truncatewords:10 }}</td>
                            <td>{{ language.date_added|date:"M d, Y" }}</td>
                            <td>
                                <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                                    <button onclick="editLanguage({{ language.id }})" class="btn btn-warning btn-sm">Edit</button>
                                    <button onclick="deleteLanguage({{ language.id }}, '{{ language.name }}')" class="btn btn-danger btn-sm">Delete</button>
                                </div>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="6" style="text-align: center; padding: 60px 20px; color: #999;">
                                <div style="font-size: 3em; margin-bottom: 15px;">ðŸ“š</div>
                                <p style="font-size: 1.1em; margin-bottom: 10px;">No languages added yet</p>
                                <p>Start tracking your learning journey!</p>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Footer Credit -->
        <div class="footer-credit">
            <p><strong>A Project by Yahya Mundewadi</strong></p>
            <p>Email: <a href="mailto:mdyahyamundewadi@gmail.com">mdyahyamundewadi@gmail.com</a></p>
            <p>Portfolio: <a href="https://yahya.dominal.in" target="_blank">yahya.dominal.in</a></p>
            <p style="margin-top: 10px; font-size: 0.9em; color: var(--text-light);">
                Project Created: 15th December 2025 | CodeShelf v1.0
            </p>
        </div>
    </div>
    
    <!-- About Modal -->
    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeAboutModal()">Ã—</button>
            <h2>About CodeShelf</h2>
            <p><strong>Project Date:</strong> 15th December 2025</p>
            <p><strong>Developer:</strong> Yahya Mundewadi</p>
            <p><strong>Contact:</strong> <a href="mailto:mdyahyamundewadi@gmail.com">mdyahyamundewadi@gmail.com</a></p>
            <p><strong>Portfolio:</strong> <a href="https://yahya.dominal.in" target="_blank">yahya.dominal.in</a></p>
            
            <h3 style="margin-top: 25px; margin-bottom: 15px; color: var(--primary);">Assignment Requirements Met</h3>
            <ul>
                <li><strong>âœ… CRUD Operations:</strong> Full Create, Read, Update, Delete via REST API endpoints (/api/languages/)</li>
                <li><strong>âœ… External API Integration:</strong> Imports programming languages from GitHub's language colors API</li>
                <li><strong>âœ… Data Visualization:</strong> Interactive charts showing category distribution and proficiency levels</li>
                <li><strong>âœ… Database:</strong> PostgreSQL database deployed on Render</li>
                <li><strong>âœ… Python & Django:</strong> Backend built with Django + Django REST Framework</li>
                <li><strong>âœ… Responsive Design:</strong> Professional UI optimized for mobile, tablet, and desktop</li>
            </ul>
            
            <h3 style="margin-top: 25px; margin-bottom: 15px; color: var(--primary);">Additional Features</h3>
            <ul>
                <li>Study session tracking with time logging</li>
                <li>Progress analytics with Chart.js visualizations</li>
                <li>Real-time search and category filtering</li>
                <li>Export data to CSV, PDF, and PNG formats</li>
                <li>Dark mode toggle for better UX</li>
                <li>Professional SVG icons throughout</li>
                <li>Inline add/edit forms for seamless CRUD operations</li>
                <li>Sortable table columns</li>
            </ul>
            
            <p style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #ddd;">
                <strong>Tech Stack:</strong> Django, Django REST Framework, PostgreSQL, Chart.js, HTML5, CSS3, Vanilla JavaScript
            </p>
        </div>
    </div>

    <script>
        // Initialize date input to today
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('studyDate').value = today;
            
            // Load study data from localStorage
            loadStudyData();
            
            // Initialize charts
            initializeCharts();
        });
        
        // Dark Mode Toggle
        function toggleDarkMode() {
            const body = document.body;
            const btn = document.getElementById('themeToggle');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                btn.innerHTML = `
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    Dark
                `;
            } else {
                body.setAttribute('data-theme', 'dark');
                btn.innerHTML = `
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    Light
                `;
            }
        }
        
        // About Modal
        function openAboutModal() {
            document.getElementById('aboutModal').classList.add('active');
        }
        
        function closeAboutModal() {
            document.getElementById('aboutModal').classList.remove('active');
        }
        
        // Study Session Functions
        function toggleStudyForm() {
            const form = document.getElementById('studyForm');
            form.classList.toggle('active');
        }
        
        function saveStudySession() {
            const language = document.getElementById('studyLanguage').value;
            const duration = parseInt(document.getElementById('studyDuration').value);
            const date = document.getElementById('studyDate').value;
            const notes = document.getElementById('studyNotes').value;
            
            if (!language || !duration || !date) {
                showAlert('Please fill in all required fields', 'error');
                return;
            }
            
            // Get existing sessions from localStorage
            let sessions = JSON.parse(localStorage.getItem('studySessions') || '[]');
            
            // Add new session
            sessions.push({
                language: language,
                duration: duration,
                date: date,
                notes: notes,
                timestamp: new Date().toISOString()
            });
            
            // Save to localStorage
            localStorage.setItem('studySessions', JSON.stringify(sessions));
            
            showAlert('Study session logged successfully!', 'success');
            toggleStudyForm();
            document.getElementById('studyDuration').value = '';
            document.getElementById('studyNotes').value = '';
            
            // Update stats
            loadStudyData();
        }
        
        function loadStudyData() {
            const sessions = JSON.parse(localStorage.getItem('studySessions') || '[]');
            const today = new Date().toISOString().split('T')[0];
            const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
            
            // Calculate today's minutes
            const todayMinutes = sessions
                .filter(s => s.date === today)
                .reduce((sum, s) => sum + s.duration, 0);
            
            // Calculate this week's minutes
            const weekMinutes = sessions
                .filter(s => s.date >= weekAgo)
                .reduce((sum, s) => sum + s.duration, 0);
            
            // Update display
            document.getElementById('todayMinutes').textContent = todayMinutes;
            document.getElementById('weekMinutes').textContent = weekMinutes;
            document.getElementById('totalSessions').textContent = sessions.length;
        }
        
        // Chart Initialization
        function initializeCharts() {
            // Category Chart
            const ctxCategory = document.getElementById('categoryChart').getContext('2d');
            new Chart(ctxCategory, {
                type: 'doughnut',
                data: {
                    labels: ['Full Stack Dev', 'Cyber Security', 'Data Science'],
                    datasets: [{
                        data: [{{ fsd_count }}, {{ cs_count }}, {{ ds_count }}],
                        backgroundColor: ['#1976d2', '#c62828', '#7b1fa2'],
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Proficiency Chart
            const ctxProf = document.getElementById('proficiencyChart').getContext('2d');
            const profCounts = {
                'Beginner': 0,
                'Intermediate': 0,
                'Advanced': 0,
                'Expert': 0
            };
            
            // Count proficiency levels from table
            const rows = document.querySelectorAll('#languagesTable tbody tr');
            rows.forEach(row => {
                const profBadge = row.querySelector('.badge-beginner, .badge-intermediate, .badge-advanced, .badge-expert');
                if (profBadge) {
                    const prof = profBadge.textContent.trim();
                    if (profCounts[prof] !== undefined) {
                        profCounts[prof]++;
                    }
                }
            });
            
            new Chart(ctxProf, {
                type: 'bar',
                data: {
                    labels: ['Beginner', 'Intermediate', 'Advanced', 'Expert'],
                    datasets: [{
                        label: 'Number of Languages',
                        data: [profCounts.Beginner, profCounts.Intermediate, profCounts.Advanced, profCounts.Expert],
                        backgroundColor: ['#ef6c00', '#2e7d32', '#0277bd', '#6a1b9a'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // Alert Function
        function showAlert(message, type) {
            const alertBox = document.getElementById('alertBox');
            alertBox.textContent = message;
            alertBox.className = `alert alert-${type} active`;
            setTimeout(() => {
                alertBox.classList.remove('active');
            }, 4000);
        }
        
        // Form Functions
        function toggleAddForm() {
            const form = document.getElementById('languageForm');
            form.classList.toggle('active');
            document.getElementById('formTitle').textContent = 'Add New Language';
            document.getElementById('langForm').reset();
            document.getElementById('editId').value = '';
        }
        
        function cancelForm() {
            document.getElementById('languageForm').classList.remove('active');
            document.getElementById('langForm').reset();
            document.getElementById('editId').value = '';
        }
        
        // Save Language
        function saveLanguage() {
            const editId = document.getElementById('editId').value;
            const data = {
                name: document.getElementById('name').value,
                category: document.getElementById('category').value,
                proficiency: document.getElementById('proficiency').value,
                description: document.getElementById('description').value,
                resources: document.getElementById('resources').value
            };
            
            if (!data.name || !data.category || !data.proficiency) {
                showAlert('Please fill in all required fields', 'error');
                return;
            }
            
            const url = editId ? `/api/languages/${editId}/` : '/api/languages/';
            const method = editId ? 'PUT' : 'POST';
            
            fetch(url, {
                method: method,
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(result => {
                showAlert(`Language ${editId ? 'updated' : 'added'} successfully!`, 'success');
                setTimeout(() => location.reload(), 1500);
            })
            .catch(error => {
                showAlert('Failed to save. Please try again.', 'error');
                console.error('Error:', error);
            });
        }
        
        // Edit Language
        function editLanguage(id) {
            fetch(`/api/languages/${id}/`)
                .then(response => response.json())
                .then(data => {
                    document.getElementById('formTitle').textContent = 'Edit Language';
                    document.getElementById('editId').value = id;
                    document.getElementById('name').value = data.name;
                    document.getElementById('category').value = data.category;
                    document.getElementById('proficiency').value = data.proficiency;
                    document.getElementById('description').value = data.description || '';
                    document.getElementById('resources').value = data.resources || '';
                    document.getElementById('languageForm').classList.add('active');
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                })
                .catch(error => {
                    showAlert('Failed to load language data', 'error');
                });
        }
        
        // Delete Language
        function deleteLanguage(id, name) {
            if (!confirm(`Are you sure you want to delete "${name}"?\n\nThis action cannot be undone.`)) {
                return;
            }
            
            fetch(`/api/languages/${id}/`, {
                method: 'DELETE',
            })
            .then(response => {
                if (response.ok || response.status === 204) {
                    showAlert(`"${name}" deleted successfully!`, 'success');
                    setTimeout(() => location.reload(), 1500);
                } else {
                    showAlert('Failed to delete. Please try again.', 'error');
                }
            })
            .catch(error => {
                showAlert('Error occurred while deleting', 'error');
            });
        }
        
        // Import Languages
        function importLanguages() {
            if (!confirm('Import sample programming languages from external API?\n\nThis will add new languages to your collection.')) {
                return;
            }
            
            showAlert('Importing languages from GitHub API...', 'success');
            
            fetch('/api/import-languages/')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        showAlert(data.message, 'success');
                        setTimeout(() => location.reload(), 2000);
                    } else {
                        showAlert('Error: ' + data.message, 'error');
                    }
                })
                .catch(error => {
                    showAlert('Failed to import languages', 'error');
                });
        }
        
        // Search Table
        function searchTable() {
            const input = document.getElementById('searchBox');
            const filter = input.value.toLowerCase();
            const table = document.querySelector('#languagesTable tbody');
            const rows = table.getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let found = false;
                
                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toLowerCase().includes(filter)) {
                        found = true;
                        break;
                    }
                }
                
                rows[i].style.display = found ? '' : 'none';
            }
        }
        
        // Filter by Category
        function filterCategory(cat) {
            const table = document.querySelector('#languagesTable tbody');
            const rows = table.getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                if (cat === 'all') {
                    rows[i].style.display = '';
                } else {
                    const badge = rows[i].querySelector('.badge');
                    if (badge && badge.classList.contains('badge-' + cat.toLowerCase())) {
                        rows[i].style.display = '';
                    } else {
                        rows[i].style.display = 'none';
                    }
                }
            }
        }
        
        // Sort Table
        function sortTable(n) {
            const table = document.getElementById('languagesTable');
            let switching = true;
            let dir = 'asc';
            let switchcount = 0;
            
            while (switching) {
                switching = false;
                const rows = table.rows;
                
                for (let i = 1; i < (rows.length - 1); i++) {
                    let shouldSwitch = false;
                    const x = rows[i].getElementsByTagName('TD')[n];
                    const y = rows[i + 1].getElementsByTagName('TD')[n];
                    
                    if (dir === 'asc') {
                        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    } else {
                        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    }
                }
                
                if (shouldSwitch) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                    switchcount++;
                } else {
                    if (switchcount === 0 && dir === 'asc') {
                        dir = 'desc';
                        switching = true;
                    }
                }
            }
        }
        
        // Export to CSV
        function exportToCSV() {
            const table = document.getElementById('languagesTable');
            let csv = [];
            const rows = table.querySelectorAll('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const cols = rows[i].querySelectorAll('td, th');
                let row = [];
                for (let j = 0; j < cols.length - 1; j++) {
                    row.push('"' + cols[j].innerText.replace(/"/g, '""') + '"');
                }
                csv.push(row.join(','));
            }
            
            const csvContent = csv.join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'codeshelf_languages.csv';
            a.click();
            window.URL.revokeObjectURL(url);
            
            showAlert('CSV downloaded successfully!', 'success');
        }
        
        // Export to PDF
        function exportToPDF() {
            showAlert('Generating PDF...', 'success');
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Title
            doc.setFontSize(20);
            doc.setTextColor(102, 126, 234);
            doc.text('CodeShelf - My Languages', 20, 20);
            
            // Subtitle
            doc.setFontSize(10);
            doc.setTextColor(100);
            doc.text('Generated by Yahya Mundewadi | ' + new Date().toLocaleDateString(), 20, 28);
            
            // Table
            const table = document.getElementById('languagesTable');
            const rows = table.querySelectorAll('tbody tr');
            
            let y = 40;
            doc.setFontSize(12);
            doc.setTextColor(0);
            
            rows.forEach((row, index) => {
                if (y > 270) {
                    doc.addPage();
                    y = 20;
                }
                
                const cells = row.querySelectorAll('td');
                if (cells.length > 0) {
                    const name = cells[0].textContent.trim();
                    const category = cells[1].textContent.trim();
                    const proficiency = cells[2].textContent.trim();
                    const description = cells[3].textContent.trim();
                    
                    doc.setFontSize(14);
                    doc.setFont(undefined, 'bold');
                    doc.text(name, 20, y);
                    
                    doc.setFontSize(10);
                    doc.setFont(undefined, 'normal');
                    doc.text(`${category} | ${proficiency}`, 20, y + 6);
                    
                    doc.setFontSize(9);
                    const splitDesc = doc.splitTextToSize(description, 170);
                    doc.text(splitDesc, 20, y + 12);
                    
                    y += 25;
                }
            });
            
            doc.save('codeshelf_languages.pdf');
            showAlert('PDF downloaded successfully!', 'success');
        }
        
        // Download as Image
        function downloadAsImage() {
            showAlert('Generating image...', 'success');
            
            const section = document.getElementById('languagesSection');
            
            html2canvas(section, {
                backgroundColor: '#ffffff',
                scale: 2
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'codeshelf_languages.png';
                link.href = canvas.toDataURL();
                link.click();
                showAlert('Image downloaded successfully!', 'success');
            });
        }
    </script>
</body>
</html>
